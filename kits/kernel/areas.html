
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Areas &#8212; The Haiku Book  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/haiku.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/code.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Images" href="images.html" />
    <link rel="prev" title="BWindow" href="../interface/window.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../index.html">
          <span>API Documentation</span></a></h1>
        <h2 class="heading"><span>Areas</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="../interface/window.html">BWindow</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="images.html">Images</a>&#160;&#160;»
        </p>

      </div>
        
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Areas</a><ul>
<li><a class="reference internal" href="#area-functions">Area Functions</a><ul>
<li><a class="reference internal" href="#_CPPv48area_forPv">area_for</a></li>
<li><a class="reference internal" href="#_CPPv410clone_areaPKcPPv6uint326uint327area_id">clone_area</a></li>
<li><a class="reference internal" href="#_CPPv411create_areaPKcPPv6uint326uint326uint326uint32">create_area</a></li>
<li><a class="reference internal" href="#_CPPv411delete_area7area_id">delete_area</a></li>
<li><a class="reference internal" href="#_CPPv49find_areaPKc">find_area</a></li>
<li><a class="reference internal" href="#_CPPv413get_area_info7area_idP9area_info">get_area_info</a></li>
<li><a class="reference internal" href="#_CPPv418get_next_area_info7team_idP5int32P9area_info">get_next_area_info</a></li>
<li><a class="reference internal" href="#_CPPv411resize_area7area_id6size_t">resize_area</a></li>
<li><a class="reference internal" href="#_CPPv419set_area_protection7area_id6uint32">set_area_protection</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>

        </div>
      </div>
          <div class="bodywrapper">
      <div class="content" role="main">
        
  <section id="areas">
<h1 id="CPPv45Areas">Areas<a class="headerlink" href="#areas" title="Permalink to this heading">¶</a></h1>
<table class="colwidths-auto docutils align-left">
<tbody>
<tr class="row-odd"><td><p>Declared in:</p></td>
<td><p>kernel/OS.h</p></td>
</tr>
<tr class="row-even"><td><p>Library:</p></td>
<td><p>libroot.so</p></td>
</tr>
</tbody>
</table>
<p>An area is a chunk of virtual memory that can be shared between threads
(possibly in different teams). If your application needs to allocate large
chunks of memory, or wants to share lots of data with another application,
you should consider using an area.</p>
<p>For more on area concepts, see “<span class="xref std std-ref">Areas Overview</span>”.</p>
<p>For examples of creating and sharing areas, see “<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Area</span> <span class="pre">Examples</span></code>”.</p>
<section id="area-functions">
<h2>Area Functions<a class="headerlink" href="#area-functions" title="Permalink to this heading">¶</a></h2>
<section id="_CPPv48area_forPv">
</section>
<h3>
area_for()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="n">area_id</span><span class="w"> </span><span class="n">area_for</span><span class="sig-paren">(</span><span class="kt">void</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">addr</span><span class="sig-paren">)</span></pre><p>Returns the area that contains the given address (within your own team’s
address space). The argument needn’t be the starting address of an area,
nor must it start on a page boundary: If the address lies anywhere within
one of your application’s areas, the ID of that area is returned.</p>
<p>Since the address is taken to be in the local address space, the area
that’s returned will also be local—it will have been created or cloned by
your application.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ERROR</span></code>.</p></td>
<td><p>The address doesn’t lie within an area.</p></td>
</tr>
</tbody>
</table>
<p>See also: <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">find_area()</span></code></p>
<section id="_CPPv410clone_areaPKcPPv6uint326uint327area_id">
</section>
<h3>
clone_area()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="n">area_id</span><span class="w"> </span><span class="n">clone_area</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">clone_name</span>, <span class="kt">void</span><span class="w"> </span><span class="p">*</span><span class="p">*</span><span class="n sig-param">clone_addr</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">clone_addr_spec</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">clone_protection</span>, <span class="n">area_id</span><span class="w"> </span><span class="n sig-param">source_area</span><span class="sig-paren">)</span></pre><p>Creates a new area (the clone area) that maps to the same physical memory
as an existing area (the source area).</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>clone_name</p></td>
<td><p>Is the name that you wish to assign to the clone area. Area names are, at
most, <a class="reference internal" href="miscellaneous.html#_CPPv416B_OS_NAME_LENGTH" title="B_OS_NAME_LENGTH"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OS_NAME_LENGTH</span></code></a> characters long.</p></td>
</tr>
<tr class="row-odd"><td><p>clone_addr</p></td>
<td><p>Points to a value that gives the address at which you want the clone area
to start; the pointed-to value must be a multiple of
<a class="reference internal" href="miscellaneous.html#_CPPv411B_PAGE_SIZE" title="B_PAGE_SIZE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_PAGE_SIZE</span></code></a> (4096). The function sets the value pointed
to by <span class="hparameter">clone_addr</span> to the area’s actual starting address—it may be
different from the one you requested. The constancy of <code class="docutils literal notranslate"><span class="pre">*clone_addr</span></code>
depends on the value of <span class="hparameter">clone_addr_spec</span>, as explained next.</p></td>
</tr>
<tr class="row-even"><td><p>clone_addr_spec</p></td>
<td><p>Is one of four constants that describes how clone_addr is to be
interpreted. The first three constants, <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_EXACT_ADDRESS</span></code>,
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BASE_ADDRESS</span></code>, and <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ANY_ADDRESS</span></code>, have
meanings as explained under <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">create_area()</span></code>.</p>
<p>The fourth constant, <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CLONE_ADDRESS</span></code>, specifies that the
address of the cloned area should be the same as the address of the source
area. Cloning the address is convenient if you have two (or more)
applications that want to pass pointers to each other—by using cloned
addresses, the applications won’t have to offset the pointers that they
receive. For both the <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ANY_ADDRESS</span></code> and
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CLONE_ADDRESS</span></code> specifications, the value that’s pointed
to by the <span class="hparameter">clone_addr</span> argument is ignored.</p>
</td>
</tr>
<tr class="row-odd"><td><p>clone_protection</p></td>
<td><p>Is one or both of <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_READ_AREA</span></code> and
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_WRITE_AREA</span></code>. These have the same meaning as in
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">create_area()</span></code>; keep in mind, as described there,
that a cloned area can have a protection that’s different from that of its
source.</p></td>
</tr>
<tr class="row-even"><td><p>source_area</p></td>
<td><p>Is the <span class="htype">area_id</span> of the area that you wish to clone. You usually
supply this value by passing an area name to the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">find_area()</span></code> function.</p></td>
</tr>
</tbody>
</table>
<p>The cloned area inherits the source area’s locking scheme.</p>
<p>Usually, the source area and clone area are in two different applications.
It’s possible to clone an area from a source that’s in the same
application, but there’s not much reason to do so unless you want the areas
to have different protections.</p>
<p>If clone_area() clone is successful, the clone’s <span class="htype">area_id</span> is
returned. Otherwise, it returns a descriptive error code, listed below.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p>Bad argument value; you passed an unrecognized constant for
<span class="hparameter">addr_spec</span> or <span class="hparameter">lock</span>, the <span class="hparameter">addr</span> value isn’t a
multiple of <a class="reference internal" href="miscellaneous.html#_CPPv411B_PAGE_SIZE" title="B_PAGE_SIZE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_PAGE_SIZE</span></code></a>, you set <span class="hparameter">addr_spec</span> to
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_EXACT_ADDRESS</span></code> or <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CLONE_ADDRESS</span></code> but
the address request couldn’t be fulfilled, or <span class="hparameter">source_area</span> doesn’t
identify an existing area.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_MEMORY</span></code>.</p></td>
<td><p>Not enough memory to allocate the system structures that support this area
(unlikely).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ERROR</span></code>.</p></td>
<td><p>Some other system error prevented the area from being created.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv411create_areaPKcPPv6uint326uint326uint326uint32">
</section>
<h3>
create_area()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="n">area_id</span><span class="w"> </span><span class="n">create_area</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span>, <span class="kt">void</span><span class="w"> </span><span class="p">*</span><span class="p">*</span><span class="n sig-param">addr</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">addr_spec</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">size</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">lock</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">protection</span><span class="sig-paren">)</span></pre><p>Creates a new area and returns its <span class="htype">area_id</span>.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>Is the name that you wish to assign to the area. It needn’t be unique.
Area names are, at most, <a class="reference internal" href="miscellaneous.html#_CPPv416B_OS_NAME_LENGTH" title="B_OS_NAME_LENGTH"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OS_NAME_LENGTH</span></code></a> (32) characters
long.</p></td>
</tr>
<tr class="row-odd"><td><p>addr</p></td>
<td><p>Points to the address at which you want the area to start. The value of
<code class="docutils literal notranslate"><span class="pre">*addr</span></code> must signify a page boundary; in other words, it must be an integer
multiple of <a class="reference internal" href="miscellaneous.html#_CPPv411B_PAGE_SIZE" title="B_PAGE_SIZE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_PAGE_SIZE</span></code></a> (4096). Note that this is a
pointer to a pointer: <code class="docutils literal notranslate"><span class="pre">*addr</span></code>—not <span class="hparameter">addr</span>—should be set to the
desired address; you then pass the address of <span class="hparameter">addr</span> as the
argument, as shown below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Set the address to a page boundary. */</span><span class="w"></span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">B_PAGE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* Pass the address of addr as the second argument. */</span><span class="w"></span>
<span class="n">create_area</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;my area&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span><span class="w"></span>
</pre></div>
</div>
<p>The function sets the value of <code class="docutils literal notranslate"><span class="pre">*addr</span></code> to the area’s actual starting
address—it may be different from the one you requested. The constancy of
<code class="docutils literal notranslate"><span class="pre">*addr</span></code> depends on the value of <span class="hparameter">addr_spec</span>, as explained next.</p>
</td>
</tr>
<tr class="row-even"><td><p>addr_spec</p></td>
<td><p>Is a constant that tells the function how the <code class="docutils literal notranslate"><span class="pre">*addr</span></code> value should be
applied. There are three useful address specification constants, and one
that doesn’t apply here:</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Constant</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_EXACT_ADDRESS</span></code></p></td>
<td><p>You want the value of <code class="docutils literal notranslate"><span class="pre">*addr</span></code> to be taken literally and strictly. If the
area can’t be allocated at that location, the function fails.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BASE_ADDRESS</span></code></p></td>
<td><p>The area can start at a location equal to or greater than <code class="docutils literal notranslate"><span class="pre">*addr</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ANY_ADDRESS</span></code></p></td>
<td><p>The starting address is determined by the system. In this case, the value
that’s pointed to by <span class="hparameter">addr</span> is ignored (going into the function).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ANY_KERNEL_ADDRESS</span></code></p></td>
<td><p>The starting address is determined by the system, and the new area will
belong to the kernel’s team; it won’t be deleted when the application
quits. In this case, the value that’s pointed to by <span class="hparameter">addr</span> is
ignored (going into the function).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CLONE_ADDRESS</span></code></p></td>
<td><p>This is only meaningful to the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">clone_area()</span></code>
function.</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p>Constant</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_EXACT_ADDRESS</span></code></p></td>
<td><p>You want the value of <code class="docutils literal notranslate"><span class="pre">*addr</span></code> to be taken literally and strictly. If the
area can’t be allocated at that location, the function fails.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BASE_ADDRESS</span></code></p></td>
<td><p>The area can start at a location equal to or greater than <code class="docutils literal notranslate"><span class="pre">*addr</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ANY_ADDRESS</span></code></p></td>
<td><p>The starting address is determined by the system. In this case, the value
that’s pointed to by <span class="hparameter">addr</span> is ignored (going into the function).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ANY_KERNEL_ADDRESS</span></code></p></td>
<td><p>The starting address is determined by the system, and the new area will
belong to the kernel’s team; it won’t be deleted when the application
quits. In this case, the value that’s pointed to by <span class="hparameter">addr</span> is
ignored (going into the function).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CLONE_ADDRESS</span></code></p></td>
<td><p>This is only meaningful to the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">clone_area()</span></code>
function.</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>Is the size, in bytes, of the area. The size must be an integer multiple
of <a class="reference internal" href="miscellaneous.html#_CPPv411B_PAGE_SIZE" title="B_PAGE_SIZE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_PAGE_SIZE</span></code></a> (4096). The upper limit of size depends on
the available swap space (or RAM, if the area is to be locked).</p></td>
</tr>
<tr class="row-even"><td><p>lock</p></td>
<td><p>Describes how the physical memory should be treated with regard to
swapping. There are four locking constants:</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Constant</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FULL_LOCK</span></code></p></td>
<td><p>The area’s memory is locked into RAM when the area is created, and won’t
be swapped out.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CONTIGUOUS</span></code></p></td>
<td><p>Not only is the area’s memory locked into RAM, it’s also guaranteed to be
contiguous. This is particularly—and perhaps exclusively—useful to
designers of certain types of device drivers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_LAZY_LOCK</span></code></p></td>
<td><p>Allows individual pages of memory to be brought into RAM through the
natural order of things and then locks them.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_LOCK</span></code></p></td>
<td><p>Pages are never locked, they’re swapped in and out as needed.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_LOMEM</span></code></p></td>
<td><p>This is a special constant that’s used for for areas that need to be
locked, contiguous, and that fit within the first 16MB of physical memory.
The folks that need this constant know who they are.</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p>Constant</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FULL_LOCK</span></code></p></td>
<td><p>The area’s memory is locked into RAM when the area is created, and won’t
be swapped out.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CONTIGUOUS</span></code></p></td>
<td><p>Not only is the area’s memory locked into RAM, it’s also guaranteed to be
contiguous. This is particularly—and perhaps exclusively—useful to
designers of certain types of device drivers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_LAZY_LOCK</span></code></p></td>
<td><p>Allows individual pages of memory to be brought into RAM through the
natural order of things and then locks them.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_LOCK</span></code></p></td>
<td><p>Pages are never locked, they’re swapped in and out as needed.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_LOMEM</span></code></p></td>
<td><p>This is a special constant that’s used for for areas that need to be
locked, contiguous, and that fit within the first 16MB of physical memory.
The folks that need this constant know who they are.</p></td>
</tr>
<tr class="row-odd"><td><p>protection</p></td>
<td><p>Is a mask that describes whether the memory can be written and read. You
form the mask by adding the constants <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_READ_AREA</span></code> (the
area can be read) and <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_WRITE_AREA</span></code> (it can be written).
The protection you describe applies only to this area. If your area is
cloned, the clone can specify a different protection.</p></td>
</tr>
</tbody>
</table>
<p>If create_area() is successful, the new area_id number is returned. If
it’s unsuccessful, one of the following error constants is returned.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p>Bad argument value. You passed an unrecognized constant for
<span class="hparameter">addr_spec</span> or <span class="hparameter">lock</span>, the <span class="hparameter">addr</span> or <span class="hparameter">size</span>
value isn’t a multiple of <a class="reference internal" href="miscellaneous.html#_CPPv411B_PAGE_SIZE" title="B_PAGE_SIZE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_PAGE_SIZE</span></code></a>, or you set
<span class="hparameter">addr_spec</span> to <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_EXACT_ADDRESS</span></code> but the address
request couldn’t be fulfilled.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_MEMORY</span></code>.</p></td>
<td><p>Not enough memory to allocate the system structures that support this area
(unlikely), not enough physical memory to support a locked area, or not
enough swap space to allocate virtual memory (in other words, size is too
big.)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ERROR</span></code>.</p></td>
<td><p>Some other system error prevented the area from being created.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv411delete_area7area_id">
</section>
<h3>
delete_area()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="n">delete_area</span><span class="sig-paren">(</span><span class="n">area_id</span><span class="w"> </span><span class="n sig-param">area</span><span class="sig-paren">)</span></pre><p>Deletes the designated area. If no one other area maps to the physical
memory that this area represents, the memory is freed. After being deleted,
the <span class="hparameter">area</span> value is invalid as an area identifier.</p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>Currently, anybody can delete any area—the act isn’t denied if, for
example, the <span class="htype">area_id</span> argument was created by another application.
This freedom will be rescinded in a later release. Until then, try to avoid
deleting other application’s areas.</p>
</div>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The area was deleted; <span class="hparameter">area</span> is now invalid.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ERROR</span></code>.</p></td>
<td><p><span class="hparameter">area</span> doesn’t designate an actual area.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv49find_areaPKc">
</section>
<h3>
find_area()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="n">area_id</span><span class="w"> </span><span class="n">find_area</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span><span class="sig-paren">)</span></pre><p>Returns an area that has a name that matches the argument. Area names
needn’t be unique—successive calls to this function with the same argument
value may not return the same <span class="htype">area_id</span>.</p>
<p>What you do with the area you’ve found depends on where it came from:</p>
<ul class="simple">
<li><p>If you’re finding an area that your own application created or cloned, you
can use the returned ID directly.</p></li>
<li><p>If the area was created or cloned by some other application, you should
immediately clone the area (unless you’re doing something truly innocuous,
such as simply examining the area’s info structure).</p></li>
</ul>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NAME_NOT_FOUND</span></code>.</p></td>
<td><p>The argument doesn’t identify an existing area.</p></td>
</tr>
</tbody>
</table>
<p>See also: <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">area_for()</span></code></p>
<section id="_CPPv413get_area_info7area_idP9area_info">
</section>
<section id="_CPPv418get_next_area_info7team_idP5int32P9area_info">
</section>
<h3>
get_area_info(), get_next_area_info()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="n">get_area_info</span><span class="sig-paren">(</span><span class="n">area_id</span><span class="w"> </span><span class="n sig-param">area</span>, <span class="n">area_info</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">info</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="n">get_next_area_info</span><span class="sig-paren">(</span><span class="n">team_id</span><span class="w"> </span><span class="n sig-param">team</span>, <span class="n">int32</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">cookie</span>, <span class="n">area_info</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">info</span><span class="sig-paren">)</span></pre><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">area_info</span><span class="w"></span>
</pre></div>
</div>
<p>Copies information about a particular area into the <span class="htype">area_info</span>
structure designated by <span class="hparameter">info</span>. The first version of the function
designates the area directly, by <span class="htype">area_id</span>.</p>
<p>The get_next_area_info() version lets you step through the list of a
team’s areas through iterated calls on the function. The <span class="hparameter">team</span>
argument identifies the team you want to look at; a <span class="hparameter">team</span> value of
0 means the team of the calling thread. The <span class="hparameter">cookie</span> argument is a
placemark; you set it to 0 on your first call, and let the function do the
rest. The function returns <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code> when there are no
more areas to visit:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Get the area_info for every area in this team. */</span><span class="w"></span>
<span class="n">area_info</span><span class="w"> </span><span class="n">info</span><span class="p">;</span><span class="w"></span>
<span class="n">int32</span><span class="w"> </span><span class="n">cookie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">get_next_area_info</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">cookie</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">B_OK</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">...</span><span class="w"></span>
</pre></div>
</div>
<p>The <span class="htype">area_info</span> structure is:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">area_info</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">area_id</span><span class="w"> </span><span class="n">area</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w">    </span><span class="n">name</span><span class="p">[</span><span class="n">B_OS_NAME_LENGTH</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">  </span><span class="n">size</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">uint32</span><span class="w">  </span><span class="n">lock</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">uint32</span><span class="w">  </span><span class="n">protection</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">team_id</span><span class="w"> </span><span class="n">team</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">  </span><span class="n">ram_size</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">uint32</span><span class="w">  </span><span class="n">copy_count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">uint32</span><span class="w">  </span><span class="n">in_count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">uint32</span><span class="w">  </span><span class="n">out_count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="o">*</span><span class="w">   </span><span class="n">address</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">area_info</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The fields are:</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>area</p></td>
<td><p>Is the <span class="htype">area_id</span> that identifies the area.</p></td>
</tr>
<tr class="row-odd"><td><p>name</p></td>
<td><p>Is the name that was assigned to the area when it was created or cloned.</p></td>
</tr>
<tr class="row-even"><td><p>size</p></td>
<td><p>Is the (virtual) size of the area, in bytes.</p></td>
</tr>
<tr class="row-odd"><td><p>lock</p></td>
<td><p>Is a constant that represents the area’s locking scheme. This will be one
of <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FULL_LOCK</span></code>, <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_CONTIGUOUS</span></code>,
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_LAZY_LOCK</span></code>, <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_LOCK</span></code>, or
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_LOMEM</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>protection</p></td>
<td><p>Specifies whether the area’s memory can be read or written. It’s a
combination of <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_READ_AREA</span></code> and
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_WRITE_AREA</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>team</p></td>
<td><p>Is the <span class="htype">team_id</span> of the team that created or cloned this area.</p></td>
</tr>
<tr class="row-even"><td><p>address</p></td>
<td><p>Is a pointer to the area’s starting address. Keep in mind that this
address is only meaningful to the team that created (or cloned) the area.</p></td>
</tr>
</tbody>
</table>
<p>The final four fields give information about the area that’s useful in
diagnosing system use. The fields are particularly valuable if you’re
hunting for memory leaks:</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ram_size</p></td>
<td><p>Gives the amount of the area, in bytes, that’s currently swapped in.</p></td>
</tr>
<tr class="row-odd"><td><p>copy_count</p></td>
<td><p>Is a “copy-on write” count that can be ignored—it doesn’t apply to the
areas that you create. The system can create copy-on-write areas (it does
so when it loads the data section of an executable, for example), but you
can’t.</p></td>
</tr>
<tr class="row-even"><td><p>in_count</p></td>
<td><p>Is a count of the total number of times any of the pages in the area have
been swapped in.</p></td>
</tr>
<tr class="row-odd"><td><p>out_count</p></td>
<td><p>Is a count of the total number of times any of the pages in the area have
been swapped out.</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The area was found; <span class="hparameter">info</span> contains valid information.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p><span class="hparameter">area</span> doesn’t identify an existing area, <span class="hparameter">team</span> doesn’t
identify an existing team, or there are no more areas to visit.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv411resize_area7area_id6size_t">
</section>
<h3>
resize_area()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="n">resize_area</span><span class="sig-paren">(</span><span class="n">area_id</span><span class="w"> </span><span class="n sig-param">area</span>, <span class="n">size_t</span><span class="w"> </span><span class="n sig-param">new_size</span><span class="sig-paren">)</span></pre><p>Sets the size of the designated area to <span class="hparameter">new_size</span>, measured in
bytes. The <span class="hparameter">new_size</span> argument must be a multiple of
<a class="reference internal" href="miscellaneous.html#_CPPv411B_PAGE_SIZE" title="B_PAGE_SIZE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_PAGE_SIZE</span></code></a> (4096).</p>
<p>Size modifications affect the end of the area’s existing memory
allocation: If you’re increasing the size of the area, the new memory is
added to the end of area; if you’re shrinking the area, end pages are
released and freed. In neither case does the area’s starting address
change, nor is existing data modified (except, of course, for data that’s
lost due to shrinkage).</p>
<p>Resizing affects all areas that refer to this areas physical memory. For
example, if B is a clone of A, and you resize A, B will be automatically
resized (if possible).</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The area was successfully resized.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p><span class="hparameter">area</span> doesn’t signify a valid area, or <span class="hparameter">new_size</span> isn’t a
multiple of <a class="reference internal" href="miscellaneous.html#_CPPv411B_PAGE_SIZE" title="B_PAGE_SIZE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_PAGE_SIZE</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_MEMORY</span></code>.</p></td>
<td><p>Not enough memory to support the new portion of the area. This should only
happen if you’re increasing the size of the area.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ERROR</span></code>.</p></td>
<td><p>Some other system error prevented the area from being created.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv419set_area_protection7area_id6uint32">
</section>
<h3>
set_area_protection()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="n">set_area_protection</span><span class="sig-paren">(</span><span class="n">area_id</span><span class="w"> </span><span class="n sig-param">area</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">new_protection</span><span class="sig-paren">)</span></pre><p>Sets the given area’s read and write protection. The new_protection
argument is a mask that specifies one or both of the values
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_READ_AREA</span></code> and <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_WRITE_AREA</span></code>. The
former means that the area can be read; the latter, that it can be written
to. An area’s protection only applies to access to the underlying memory
through that specific area. Different area clones that refer to the same
memory may have different protections.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The protection was changed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p><span class="hparameter">area</span> doesn’t identify a valid area.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


        <div class="clearer"></div>
      </div>
          </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="../interface/window.html">BWindow</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="images.html">Images</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Haiku, Inc..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>BNode &#8212; The Haiku Book  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/haiku.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/code.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BNodeInfo" href="node-info.html" />
    <link rel="prev" title="BMimeType" href="mime-type.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../index.html">
          <span>API Documentation</span></a></h1>
        <h2 class="heading"><span>BNode</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="mime-type.html">BMimeType</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="node-info.html">BNodeInfo</a>&#160;&#160;»
        </p>

      </div>
        
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">BNode</a><ul>
<li><a class="reference internal" href="#constructor-and-destructor">Constructor and Destructor</a><ul>
<li><a class="reference internal" href="#_CPPv4N5BNode5BNodeEv">BNode</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNodeD0Ev">~BNode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#member-functions">Member Functions</a><ul>
<li><a class="reference internal" href="#_CPPv4NK5BNode11GetAttrInfoEPKcP9attr_info">GetAttrInfo</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode15GetNextAttrNameEPc">GetNextAttrName</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode11RewindAttrsEv">RewindAttrs</a></li>
<li><a class="reference internal" href="#_CPPv4NK5BNode9InitCheckEv">InitCheck</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode4LockEv">Lock</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode6UnlockEv">Unlock</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode8ReadAttrEPKc9type_code5off_tPv6size_t">ReadAttr</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode9WriteAttrEPKc9type_code5off_tPKv6size_t">WriteAttr</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode10RemoveAttrEPKc">RemoveAttr</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode10RenameAttrEPKcPKc">RenameAttr</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode5SetToEPK9entry_ref">SetTo</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode5UnsetEv">Unset</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNode4SyncEv">Sync</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operators">Operators</a></li>
<li><a class="reference internal" href="#defined-types">Defined Types</a><ul>
<li><a class="reference internal" href="#_CPPv4N5BNode8node_refEv">node_ref</a></li>
<li><a class="reference internal" href="#_CPPv4N5BNodeD0Ev">~node_ref</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>

        </div>
      </div>
          <div class="bodywrapper">
      <div class="content" role="main">
        
  <section id="bnode">
<h1 id="CPPv45BNode">BNode<a class="headerlink" href="#bnode" title="Permalink to this heading">¶</a></h1>
<section id="constructor-and-destructor">
<h2>Constructor and Destructor<a class="headerlink" href="#constructor-and-destructor" title="Permalink to this heading">¶</a></h2>
<section id="_CPPv4N5BNode5BNodeEv">
</section>
<h3>
BNode()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N5BNode5BNodeEv" title="BNode::BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">BNode</span><span class="sig-paren">(</span><span class="sig-paren">)</span><br /><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N5BNode5BNodeEPK9entry_ref" title="BNode::BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">BNode</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="n">entry_ref</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">ref</span><span class="sig-paren">)</span><br /><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N5BNode5BNodeEPK6BEntry" title="BNode::BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">BNode</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="entry.html#_CPPv46BEntry" title="BEntry"><span class="n">BEntry</span></a><span class="w"> </span><span class="p">*</span><span class="n sig-param">entry</span><span class="sig-paren">)</span><br /><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N5BNode5BNodeEPKc" title="BNode::BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">BNode</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">path</span><span class="sig-paren">)</span><br /><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N5BNode5BNodeEPK10BDirectoryPKc" title="BNode::BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">BNode</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="directory.html#_CPPv410BDirectory" title="BDirectory"><span class="n">BDirectory</span></a><span class="w"> </span><span class="p">*</span><span class="n sig-param">dir</span>, <span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">path</span><span class="sig-paren">)</span><br /><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N5BNode5BNodeERK5BNode" title="BNode::BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">BNode</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="#_CPPv4N5BNode5BNodeERK5BNode" title="BNode::BNode"><span class="n">BNode</span></a><span class="w"> </span><span class="p">&amp;</span><span class="n sig-param">node</span><span class="sig-paren">)</span></pre><p>Creates a new <span class="hclass">BNode</span> object that’s initialized to represent a
specific file system node. To retrieve the status of the initialization,
call <a class="reference internal" href="#_CPPv4NK5BNode9InitCheckEv" title="BNode::InitCheck"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">InitCheck()</span></code></a> immediately after
constructing the object:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">BNode</span><span class="w"> </span><span class="n">node</span><span class="p">(</span><span class="s">&quot;/boot/lbj/FidoOnFire.gif&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">InitCheck</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">B_OK</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="cm">/* The object wasn&#39;t initialized. */</span><span class="w"></span>
</pre></div>
</div>
<p>A successfully initialized <span class="hclass">BNode</span> object creates a “file
descriptor” through which the object reads and writes the node’s data and
attributes. You can only have 256 file descriptors at a time (per
application). The object’s file descriptor is closed when the object is
deleted, reset (through <a class="reference internal" href="#_CPPv4N5BNode5SetToEPK9entry_ref" title="BNode::SetTo"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">SetTo()</span></code></a>), or unset
(<a class="reference internal" href="#_CPPv4N5BNode5UnsetEv" title="BNode::Unset"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Unset()</span></code></a>).</p>
<ul class="simple">
<li><p>Default constructor. The object’s status will be
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_INIT</span></code>, and the file descriptor isn’t allocated until
you actually initialize the object with a call to <a class="reference internal" href="#_CPPv4N5BNode5SetToEPK9entry_ref" title="BNode::SetTo"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">SetTo()</span></code></a>.</p></li>
<li><p>Copy constructor. The new <span class="hclass">BNode</span> is set to the same node as the
argument. Each of the two <span class="hclass">BNode</span> objects has its own file
descriptor.</p></li>
<li><p>Other constructors. See the <a class="reference internal" href="#_CPPv4N5BNode5SetToEPK9entry_ref" title="BNode::SetTo"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">SetTo()</span></code></a> functions.</p></li>
</ul>
<section id="_CPPv4N5BNodeD0Ev">
</section>
<h3>
~BNode()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="k">virtual</span><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">~BNode</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Frees the object’s file descriptor, unlocks the node (if it was locked),
and destroys the object.</p>
</section>
<section id="member-functions">
<h2>Member Functions<a class="headerlink" href="#member-functions" title="Permalink to this heading">¶</a></h2>
<section id="_CPPv4NK5BNode11GetAttrInfoEPKcP9attr_info">
</section>
<h3>
GetAttrInfo()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">GetAttrInfo</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">attr</span>, <span class="n">attr_info</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">info</span><span class="sig-paren">)</span><span class="w"> </span><span class="k">const</span></pre><p>Gets information about the attribute named by <span class="hparameter">attr</span>. The
information is copied into the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">attr_info</span></code> parameter
<span class="hparameter">info</span>, which must be allocated before it’s passed in.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>Success.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ENTRY_NOT_FOUND</span></code>.</p></td>
<td><p>The node doesn’t have an attribute named <span class="hparameter">attr</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FILE_ERROR</span></code>.</p></td>
<td><p>The object is uninitialized.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N5BNode15GetNextAttrNameEPc">
</section>
<section id="_CPPv4N5BNode11RewindAttrsEv">
</section>
<h3>
GetNextAttrName(), RewindAttrs()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">GetNextAttrName</span><span class="sig-paren">(</span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">buffer</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">RewindAttrs</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Every <span class="hclass">BNode</span> maintains a pointer into its list of attributes.
<span class="hmethod">GetNextAttrName()</span> retrieves the name of the attribute that the
pointer is currently pointing to, and then bumps the pointer to the next
attribute. The name is copied into the buffer, which should be at least
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ATTR_NAME_LENGTH</span></code> characters long. The copied name is
<span class="cpp-expr sig sig-inline cpp"><span class="n">NULL</span></span>-terminated. When you’ve asked for every name in the list,
<span class="hmethod">GetNextAttrName()</span> returns an error.</p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p><span class="hmethod">GetNextAttrName()</span> does <strong>not</strong> clear its argument if it returns
an error. This will be corrected in a subsequent release.</p>
</div>
<p><span class="hmethod">RewindAttrs()</span> resets the <span class="hclass">BNode</span>’s attribute pointer to
the first elementin the list.</p>
<p>To visit every attribute name, you would do something like this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Print every attribute name. */</span><span class="w"></span>
<span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="n">B_ATTR_NAME_LENGTH</span><span class="p">];</span><span class="w"></span>

<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">GetNextAttrName</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">B_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;&gt; Attr name: %sn&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The attribute list is not static; when you ask for the next attribute
name, you’re asking for the next name in the list <strong>as it exists right
now</strong>.</p>
<p>Furthermore, the ordinal position of an attribute within the list is
indeterminate. “Newer” attributes are not necessarily added to the end of
the list: If you alter the list while you’re walking through it, you may
get curious results—you may not see the attribute that you just now added
(for example).</p>
<p>In general, it’s best to avoid altering the list while you’re iterating
over it.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>Success.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ENTRY_NOT_FOUND</span></code>.</p></td>
<td><p>You’ve hit the end of the list.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FILE_ERROR</span></code></p></td>
<td><p>The object is uninitialized.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4NK5BNode9InitCheckEv">
</section>
<h3>
InitCheck()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">InitCheck</span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k">const</span></pre><p>Returns the status of the most recent initialization.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The object was successfully initialized.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_INIT</span></code>.</p></td>
<td><p>The object is uninitialized.</p></td>
</tr>
<tr class="row-even"><td><p>Other return values</p></td>
<td><p>See the <a class="reference internal" href="#_CPPv4N5BNode5SetToEPK9entry_ref" title="BNode::SetTo"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">SetTo()</span></code></a> function.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N5BNode4LockEv">
</section>
<section id="_CPPv4N5BNode6UnlockEv">
</section>
<h3>
Lock(), Unlock()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">Lock</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">Unlock</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Locks and unlocks the <span class="hclass">BNode</span>’s node. While the node is locked, no
other object can access the node’s data or attributes. More precisely, no
other agent can create a file descriptor to the node. If a file descriptor
already exists to this node, the <span class="hmethod">Lock()</span> function fails.</p>
<p>See “<span class="xref std std-ref">Node Locking</span>” for details.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The node was successfully locked or unlocked.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BUSY</span></code>.</p></td>
<td><p>(<span class="hmethod">Lock()</span>) The node can’t be locked.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p>(<span class="hmethod">Unlock()</span>) The node isn’t locked.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FILE_ERROR</span></code>.</p></td>
<td><p>The object is uninitialized.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N5BNode8ReadAttrEPKc9type_code5off_tPv6size_t">
</section>
<section id="_CPPv4N5BNode9WriteAttrEPKc9type_code5off_tPKv6size_t">
</section>
<section id="_CPPv4N5BNode10RemoveAttrEPKc">
</section>
<h3>
ReadAttr(), WriteAttr(), RemoveAttr()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="n">ssize_t</span><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">ReadAttr</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span>, <span class="n">type_code</span><span class="w"> </span><span class="n sig-param">type</span>, <span class="n">off_t</span><span class="w"> </span><span class="n sig-param">offset</span>, <span class="kt">void</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">buffer</span>, <span class="n">size_t</span><span class="w"> </span><span class="n sig-param">length</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><span class="n">ssize_t</span><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">WriteAttr</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span>, <span class="n">type_code</span><span class="w"> </span><span class="n sig-param">type</span>, <span class="n">off_t</span><span class="w"> </span><span class="n sig-param">offset</span>, <span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">buffer</span>, <span class="n">size_t</span><span class="w"> </span><span class="n sig-param">length</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">RemoveAttr</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">attr</span><span class="sig-paren">)</span></pre><p>These functions read, write, and remove the node’s attributes. Attributes
are name/data pairs, where names must be unique (within a given node) and
the data can be of arbitrary length.</p>
<p><span class="hmethod">ReadAttr()</span> reads the data in the attribute named
<span class="hparameter">name</span>, and copies it in <span class="hparameter">buffer</span>. The length of the buffer
(the maximum number of bytes to copy) is given by <span class="hparameter">length</span>.
Currently, the <span class="hparameter">type</span> and <span class="hparameter">offset</span> arguments are unused (or
unreliable). The function returns the number of bytes that were actually
read.</p>
<p><span class="hmethod">WriteAttr()</span> erases the data currently held by <span class="hparameter">name</span>
(if such an attribute exists) and replaces it with a copy of the first
<span class="hparameter">length</span> bytes of data in <span class="hparameter">buffer</span>. The <span class="hparameter">type</span>
argument <strong>is</strong> remembered—you can retrieve an attribute’s type through
<a class="reference internal" href="#_CPPv4NK5BNode11GetAttrInfoEPKcP9attr_info" title="BNode::GetAttrInfo"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GetAttrInfo()</span></code></a>, for example—and you need to
specify the correct type when you’re forming a query (see
<a class="reference internal" href="query.html#_CPPv46BQuery" title="BQuery"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BQuery</span></code></a> and the note below). But, as mentioned above, you don’t
need to match types when you’re reading the attribute. The <span class="hparameter">offset</span>
argument is currently unreliable and shouldn’t be used. The functions
returns the number of bytes that were written.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>If you want to use the attribute in a query, its type must be either
<span class="htype">string</span>, <span class="htype">int32</span>, <span class="htype">uint32</span>, <span class="htype">int64</span>,
<span class="htype">uint64</span>, <span class="htype">double</span>, or <span class="htype">float</span>. (In other words,
<span class="hparameter">type</span> must be <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_STRING_TYPE</span></code>, or
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_INT32_TYPE</span></code>, or <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_UINT32_TYPE</span></code>, and so
on.)</p>
</div>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>The value of an indexed attribute must be no more than 255 bytes long.</p>
</div>
<p><span class="hmethod">RemoveAttr()</span> deletes the attribute given by <span class="hparameter">name</span>.</p>
<p><span class="hmethod">ReadAttr()</span> and <span class="hmethod">WriteAttr()</span>, if successful, return
the number of bytes read or written.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>(<span class="hmethod">RemoveAttr()</span>) The attribute was successfully removed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ENTRY_NOT_FOUND</span></code>.</p></td>
<td><p>(<span class="hmethod">ReadAttr()</span> and <span class="hmethod">RemoveAttr()</span>) The attribute doesn’t
exist.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FILE_ERROR</span></code>.</p></td>
<td><p>The object is uninitialized.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FILE_ERROR</span></code>.</p></td>
<td><p>(<span class="hmethod">WriteAttr()</span> and <span class="hmethod">RemoveAttr()</span>) This object is a
read-only <a class="reference internal" href="file.html#_CPPv45BFile" title="BFile"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BFile</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NOT_ALLOWED</span></code>.</p></td>
<td><p>(<span class="hmethod">WriteAttr()</span> and <span class="hmethod">RemoveAttr()</span>) The node is on a
read-only volume.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_DEVICE_FULL</span></code>.</p></td>
<td><p>(<span class="hmethod">WriteAttr()</span>) Out of disk space.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_MEMORY</span></code>.</p></td>
<td><p>(<span class="hmethod">WriteAttr()</span>) Not enough memory to complete the operation.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N5BNode10RenameAttrEPKcPKc">
</section>
<h3>
RenameAttr()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">RenameAttr</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span>, <span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">new_name</span><span class="sig-paren">)</span></pre><p>Moves the attribute given by <span class="hparameter">name</span> to <span class="hparameter">new_name</span>. If
<span class="hparameter">new_name</span> exists, it’s clobbered.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The attribute was successfully renamed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ENTRY_NOT_FOUND</span></code>.</p></td>
<td><p>The <span class="hparameter">name</span> attribute doesn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FILE_ERROR</span></code>.</p></td>
<td><p>The object is uninitialized.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_FILE_ERROR</span></code>.</p></td>
<td><p>This object is a read-only <a class="reference internal" href="file.html#_CPPv45BFile" title="BFile"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BFile</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NOT_ALLOWED</span></code>.</p></td>
<td><p>The node is on a read-only volume.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N5BNode5SetToEPK9entry_ref">
</section>
<section id="_CPPv4N5BNode5UnsetEv">
</section>
<h3>
SetTo(), Unset()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">SetTo</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="n">entry_ref</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">ref</span><span class="sig-paren">)</span><br /><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">SetTo</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="entry.html#_CPPv46BEntry" title="BEntry"><span class="n">BEntry</span></a><span class="w"> </span><span class="p">*</span><span class="n sig-param">entry</span><span class="sig-paren">)</span><br /><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">SetTo</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">path</span><span class="sig-paren">)</span><br /><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">SetTo</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="directory.html#_CPPv410BDirectory" title="BDirectory"><span class="n">BDirectory</span></a><span class="w"> </span><span class="p">*</span><span class="n sig-param">dir</span>, <span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">path</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><span class="kt">void</span><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">Unset</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Closes the <span class="hclass">BNode</span>’s current file descriptor and opens it on the
node (of the entry) that’s designated by the arguments.</p>
<ul class="simple">
<li><p>In the <span class="hparameter">path</span> version, <span class="hparameter">path</span> can be absolute or relative,
and can contain “.” and “..” elements. If <span class="hparameter">path</span> is relative, it’s
reckoned off of the current working directory.</p></li>
<li><p>In the <span class="hparameter">dir</span>/<span class="hparameter">path</span> version, <span class="hparameter">path</span> must be
relative. It’s reckoned off of the directory given by <span class="hparameter">dir</span>.</p></li>
</ul>
<p><span class="hclass">BNode</span> instances never traverse symbolic links. If the designated
entry is a symbolic link, the BNode will open the link’s node. (Conversely,
<a class="reference internal" href="file.html#_CPPv45BFile" title="BFile"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BFile</span></code></a> instances <strong>always</strong> traverse symbolic links.)</p>
<p><span class="hmethod">Unset()</span> closes the <span class="hclass">BNode</span>’s file descriptor and sets
<a class="reference internal" href="#_CPPv4NK5BNode9InitCheckEv" title="BNode::InitCheck"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">InitCheck()</span></code></a> to <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_INIT</span></code>.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>All is well.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p>The designated entry doesn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p>Uninitialized or malformed argument.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BUSY</span></code>.</p></td>
<td><p>The node is locked.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N5BNode4SyncEv">
</section>
<h3>
Sync()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">Sync</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Immediately performs any pending disk transactions for the file, returning
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code> on success and an appropriate error message
otherwise.</p>
</section>
<section id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Permalink to this heading">¶</a></h2>
<h3>
</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="w"> </span><span class="p">&amp;</span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="k">operator</span><span class="o">=</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="w"> </span><span class="p">&amp;</span><span class="n sig-param">node</span><span class="sig-paren">)</span></pre><p>In the expression</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">BNode</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p><span class="hclass">BNode</span> <span class="hparameter">a</span> is initialized to refer to the same node as
<span class="hparameter">b</span>. To gauge the success of the assignment, you should call
<a class="reference internal" href="#_CPPv4NK5BNode9InitCheckEv" title="BNode::InitCheck"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">InitCheck()</span></code></a> immediately afterwards. It’s
safe to assign a <span class="hclass">BNode</span> to itself.</p>
<h3>
</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="kt">bool</span><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="k">operator</span><span class="o">==</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="w"> </span><span class="p">&amp;</span><span class="n sig-param">node</span><span class="sig-paren">)</span><span class="w"> </span><span class="k">const</span></pre><pre style="background: #f3f3f3; line-height: 2em"><span class="kt">bool</span><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="k">operator</span><span class="o">!=</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="w"> </span><span class="p">&amp;</span><span class="n sig-param">node</span><span class="sig-paren">)</span><span class="w"> </span><span class="k">const</span></pre><p>Two <span class="hclass">BNode</span> objects are said to be equal if they’re set to the
same node, or if they’re both <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NO_INIT</span></code>.</p>
</section>
<section id="defined-types">
<h2>Defined Types<a class="headerlink" href="#defined-types" title="Permalink to this heading">¶</a></h2>
<section id="_CPPv4N5BNode8node_refEv">
</section>
<section id="_CPPv4N5BNodeD0Ev">
</section>
<h3>
node_ref(), ~node_ref()</h3><p>Declared in: storage/Node.h</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">node_ref</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="n">node_ref</span><span class="p">();</span><span class="w"></span>
<span class="w">              </span><span class="n">node_ref</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">node_ref</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ref</span><span class="p">);</span><span class="w"></span>
<span class="w">              </span><span class="o">~</span><span class="n">node_ref</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="kt">bool</span><span class="w">      </span><span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">node_ref</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">bool</span><span class="w">      </span><span class="k">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">node_ref</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">node_ref</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">node_ref</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ref</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">dev_t</span><span class="w">     </span><span class="n">device</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">ino_t</span><span class="w">     </span><span class="n">node</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The <span class="htype">node_ref</span> structure describes a node in a file system.</p>
<ul class="simple">
<li><p><span class="hparameter">device</span> contains the device number on which the node is located.</p></li>
<li><p><span class="hparameter">node</span> contains the inode of the node.</p></li>
</ul>
<pre style="background: #f3f3f3; line-height: 2em"><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">node_ref</span><span class="sig-paren">(</span><span class="sig-paren">)</span><br /><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">node_ref</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><a class="reference internal" href="#_CPPv4N5BNode8node_refERK8node_ref" title="BNode::node_ref"><span class="n">node_ref</span></a><span class="w"> </span><span class="p">&amp;</span><span class="n sig-param">ref</span><span class="sig-paren">)</span></pre><p>The constructor for the <span class="htype">node_ref</span> structure. The first of these
creates an empty <span class="htype">node_ref</span>, and the second duplicates an existing
<span class="htype">node_ref</span>.</p>
<pre style="background: #f3f3f3; line-height: 2em"><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv45BNode" title="BNode"><span class="n">BNode</span></a><span class="p">::</span></span><span class="n">~node_ref</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>The destructor for <span class="htype">node_ref</span>.</p>
<p><span class="hmethod">operator ==</span></p>
<p>Lets you perform comparisons of <span class="htype">node_ref</span> structures to see if
they refer to the same node.</p>
<p><span class="hmethod">operator !=</span></p>
<p>Lets you test to see if two <span class="htype">node_ref</span> structures refer to
different nodes.</p>
</section>
</section>


        <div class="clearer"></div>
      </div>
          </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="mime-type.html">BMimeType</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="node-info.html">BNodeInfo</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Haiku, Inc..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>
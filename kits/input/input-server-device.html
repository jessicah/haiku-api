
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>BInputServerDevice &#8212; The Haiku Book  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/haiku.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/code.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BInputServerFilter" href="input-server-filter.html" />
    <link rel="prev" title="BInputDevice" href="input-device.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../index.html">
          <span>API Documentation</span></a></h1>
        <h2 class="heading"><span>BInputServerDevice</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="input-device.html">BInputDevice</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="input-server-filter.html">BInputServerFilter</a>&#160;&#160;»
        </p>

      </div>
        
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">BInputServerDevice</a><ul>
<li><a class="reference internal" href="#constructor-and-destructor">Constructor and Destructor</a><ul>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice18BInputServerDeviceEv">BInputServerDevice</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice18BInputServerDeviceEv">BInputServerDevice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hook-functions">Hook Functions</a><ul>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice7ControlEPKcP3voi6uint32P8BMessage">Control</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice9InitCheckEv">InitCheck</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice5StartEPKcPv">Start</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice4StopEPKcPv">Stop</a></li>
<li><a class="reference internal" href="#_CPPv4NK18BInputServerDevice18SystemShuttingDownEv">SystemShuttingDown</a></li>
</ul>
</li>
<li><a class="reference internal" href="#member-functions">Member Functions</a><ul>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice14EnqueueMessageEP8BMessage">EnqueueMessage</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice15RegisterDevicesEPP16input_device_ref">RegisterDevices</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice17UnregisterDevicesEPP16input_device_ref">UnregisterDevices</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice21StartMonitoringDeviceEPKc">StartMonitoringDevice</a></li>
<li><a class="reference internal" href="#_CPPv4N18BInputServerDevice20StopMonitoringDeviceEPKc">StopMonitoringDevice</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>

        </div>
      </div>
          <div class="bodywrapper">
      <div class="content" role="main">
        
  <section id="binputserverdevice">
<h1 id="CPPv418BInputServerDevice">BInputServerDevice<a class="headerlink" href="#binputserverdevice" title="Permalink to this heading">¶</a></h1>
<section id="constructor-and-destructor">
<h2>Constructor and Destructor<a class="headerlink" href="#constructor-and-destructor" title="Permalink to this heading">¶</a></h2>
<section id="_CPPv4N18BInputServerDevice18BInputServerDeviceEv">
</section>
<h3>
BInputServerDevice()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N18BInputServerDevice18BInputServerDeviceEv" title="BInputServerDevice::BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">BInputServerDevice</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Creates a new BInputServerDevice object. You can initialize your
object—set initial values, spawn (but not necessarily resume; do that in
<a class="reference internal" href="#_CPPv4N18BInputServerDevice5StartEPKcPv" title="BInputServerDevice::Start"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Start()</span></code></a>) threads, open drivers,
etc.—either here or in the <a class="reference internal" href="#_CPPv4N18BInputServerDevice9InitCheckEv" title="BInputServerDevice::InitCheck"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">InitCheck()</span></code></a> function, which is called immediately
after the constructor.</p>
<section id="_CPPv4N18BInputServerDevice18BInputServerDeviceEv">
</section>
<h3>
BInputServerDevice()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv4N18BInputServerDevice18BInputServerDeviceEv" title="BInputServerDevice::BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">BInputServerDevice</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Deletes the <span class="hclass">BInputServerDevice</span> object. The destructor is invoked
by the Input Server only—you never delete a <span class="hclass">BInputServerDevice</span>
object from your own code. When the destructor is called, the object’s
devices will already be unregistered and <a class="reference internal" href="#_CPPv4N18BInputServerDevice4StopEPKcPv" title="BInputServerDevice::Stop"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Stop()</span></code></a> will already have been called. If this object
spawned its own threads or allocated memory on the heap, it must clean up
after itself here.</p>
</section>
<section id="hook-functions">
<h2>Hook Functions<a class="headerlink" href="#hook-functions" title="Permalink to this heading">¶</a></h2>
<section id="_CPPv4N18BInputServerDevice7ControlEPKcP3voi6uint32P8BMessage">
</section>
<h3>
Control()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">Control</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span>, <span class="n">voi</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">cookie</span>, <span class="n">uint32</span><span class="w"> </span><span class="n sig-param">command</span>, <a class="reference internal" href="../application/message.html#_CPPv48BMessage" title="BMessage"><span class="n">BMessage</span></a><span class="w"> </span><span class="p">*</span><span class="n sig-param">message</span><span class="sig-paren">)</span></pre><p>The <span class="hmethod">Control()</span> hook function is invoked by the Input Server to
send an input device control message or a Node Monitor message to this
object. name and cookie are the readable name and
pointer-to-whatever-you-want that you used when registering the device
(with the <a class="reference internal" href="#_CPPv4N18BInputServerDevice15RegisterDevicesEPP16input_device_ref" title="BInputServerDevice::RegisterDevices"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">RegisterDevices()</span></code></a> function).</p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>The function’s return value is ignored.</p>
</div>
<p class="rubric">Input Device Control Messages</p>
<p>An input device control message is sent when a downstream change needs to
be propagated to an input device. For example, when the user resets the
mouse speed (through the Mouse preference), a
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_MOUSE_SPEED_CHANGED</span></code> control message is sent to all
objects that have registered a <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_POINTING_DEVICE</span></code> device
(see <a class="reference internal" href="#_CPPv4N18BInputServerDevice15RegisterDevicesEPP16input_device_ref" title="BInputServerDevice::RegisterDevices"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">RegisterDevices()</span></code></a>).
<span class="hparameter">name</span> and <span class="hparameter">cookie</span> identify the device that this message
applies to. The control message itself is represented by the
<span class="hparameter">command</span> constant, optionally supplemented by <span class="hparameter">message</span>.</p>
<p>See “Input Device Control Messages” for a list of the control messages
that the BeOS defines, and instructions for how to respond to them. An
application can send a custom control message through a
<a class="reference internal" href="input-device.html#_CPPv412BInputDevice" title="BInputDevice"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BInputDevice</span></code></a> object; see <a class="reference internal" href="input-device.html#_CPPv4N12BInputDevice7ControlE6uint32P8BMessage" title="BInputDevice::Control"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">BInputDevice::Control()</span></code></a> for
details.</p>
<p class="rubric">Node Monitor Messages</p>
<p>A Node Monitor message is sent if an entry is added to or removed from one
of the device directories that the object is monitoring, as set through
<a class="reference internal" href="#_CPPv4N18BInputServerDevice21StartMonitoringDeviceEPKc" title="BInputServerDevice::StartMonitoringDevice"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">StartMonitoringDevice()</span></code></a>. In this case, <span class="hparameter">name</span>
and <span class="hparameter">cookie</span> are <span class="cpp-expr sig sig-inline cpp"><span class="n">NULL</span></span>, <span class="hparameter">command</span> is
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NODE_MONITOR</span></code>, and <span class="hparameter">message</span> describes the file
that was added or deleted. The <span class="hparameter">message</span>’s <span class="hparameter">opcode</span> field
will be <a class="reference internal" href="../storage/the-node-monitor.html#_CPPv415B_ENTRY_CREATED" title="B_ENTRY_CREATED"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ENTRY_CREATED</span></code></a> or
<a class="reference internal" href="../storage/the-node-monitor.html#_CPPv415B_ENTRY_REMOVED" title="B_ENTRY_REMOVED"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ENTRY_REMOVED</span></code></a> (or, potentially but nonsensically,
<a class="reference internal" href="../storage/the-node-monitor.html#_CPPv413B_ENTRY_MOVED" title="B_ENTRY_MOVED"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ENTRY_MOVED</span></code></a>). For instructions on how to read these
messages, see “The Node Monitor” in the Storage Kit (or click on the opcode
constants).</p>
<section id="_CPPv4N18BInputServerDevice9InitCheckEv">
</section>
<h3>
InitCheck()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="k">virtual</span><span class="w"> </span><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">InitCheck</span><span class="sig-paren">(</span><span class="sig-paren">)</span></pre><p>Invoked by the Input Server immediately after the object is constructed to
test the validity of the initialization. If the object is properly
initialized (i.e. all required resources are located or allocated), this
function should return <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>. <a class="reference internal" href="#_CPPv4N18BInputServerDevice5StartEPKcPv" title="BInputServerDevice::Start"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Start()</span></code></a> will be invoked soon if you need to do any
extra initialization. If the object returns non-<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>, the
object is deleted and the add-on is unloaded.</p>
<p>The default implementation returns <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p>
<section id="_CPPv4N18BInputServerDevice5StartEPKcPv">
</section>
<section id="_CPPv4N18BInputServerDevice4StopEPKcPv">
</section>
<h3>
Start(), Stop()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="k">virtual</span><span class="w"> </span><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">Start</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span>, <span class="kt">void</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">cookie</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><span class="k">virtual</span><span class="w"> </span><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">Stop</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">name</span>, <span class="kt">void</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">cookie</span><span class="sig-paren">)</span></pre><p><span class="hmethod">Start()</span> is invoked by the Input Server to tell the object that
it can begin sending events for the registered device identified by the
arguments. The values of the arguments are taken from the
<span class="htype">input_device_ref</span> structure you used to register the device (see
<a class="reference internal" href="#_CPPv4N18BInputServerDevice15RegisterDevicesEPP16input_device_ref" title="BInputServerDevice::RegisterDevices"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">RegisterDevices()</span></code></a>). If
your object needs to resume a thread (spawned in the constructor, in
<a class="reference internal" href="#_CPPv4N18BInputServerDevice9InitCheckEv" title="BInputServerDevice::InitCheck"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">InitCheck()</span></code></a>, or here), this is
the place to do it.</p>
<p><span class="hmethod">Stop()</span> is invoked to tell the object to stop sending events for
the registered device. The device is not unregistered—you can still receive
<a class="reference internal" href="#_CPPv4N18BInputServerDevice7ControlEPKcP3voi6uint32P8BMessage" title="BInputServerDevice::Control"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Control()</span></code></a> messages for the device
while it’s stopped. You should pause or kill any threads associated with
the device (that were spawned by this object) from here.</p>
<p>The return value (for both of these functions) is ignored.</p>
<section id="_CPPv4NK18BInputServerDevice18SystemShuttingDownEv">
</section>
<h3>
SystemShuttingDown()</h3><pre style="background: #f3f3f3; line-height: 2em"><span class="k">virtual</span><span class="w"> </span><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">SystemShuttingDown</span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k">const</span></pre><p>Tells the object that the Input Server is in the process of shutting down.
Unless something interrupts the shutdown, this notification will be
followed by a <a class="reference internal" href="#_CPPv4N18BInputServerDevice4StopEPKcPv" title="BInputServerDevice::Stop"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Stop()</span></code></a> and delete,
thus you don’t have to do much from this function (other than note that the
end is near).</p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>The return value is ignored.</p>
</div>
</section>
<section id="member-functions">
<h2>Member Functions<a class="headerlink" href="#member-functions" title="Permalink to this heading">¶</a></h2>
<section id="_CPPv4N18BInputServerDevice14EnqueueMessageEP8BMessage">
</section>
<h3>
EnqueueMessage()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">EnqueueMessage</span><span class="sig-paren">(</span><a class="reference internal" href="../application/message.html#_CPPv48BMessage" title="BMessage"><span class="n">BMessage</span></a><span class="w"> </span><span class="p">*</span><span class="n sig-param">message</span><span class="sig-paren">)</span></pre><p>Sends an event message to the Input Server, which passes it through the
input methods and input filters before sending it to the App Server. The
message you create should be appropriate for the action you’re trying to
depict. For example, if the user presses a key, you should create and send
a <code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_KEY_DOWN</span></code> message. A list of the system-defined event
messages that an input device is expected to create and send is given in
“Input Device Event Messages”.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>The message was sent.</p></td>
</tr>
<tr class="row-odd"><td><p>Anything else.</p></td>
<td><p>The connection to the App Server has been broken—this isn’t good, and you
may want to check the <span class="xref std std-ref">is_computer_on_fire()</span> function found in the
Kernel Kit.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N18BInputServerDevice15RegisterDevicesEPP16input_device_ref">
</section>
<section id="_CPPv4N18BInputServerDevice17UnregisterDevicesEPP16input_device_ref">
</section>
<h3>
RegisterDevices(), UnregisterDevices()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">RegisterDevices</span><span class="sig-paren">(</span><span class="n">input_device_ref</span><span class="w"> </span><span class="p">*</span><span class="p">*</span><span class="n sig-param">devices</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">UnregisterDevices</span><span class="sig-paren">(</span><span class="n">input_device_ref</span><span class="w"> </span><span class="p">*</span><span class="p">*</span><span class="n sig-param">devices</span><span class="sig-paren">)</span></pre><p><span class="hmethod">RegisterDevices()</span> tells the Input Server that this object is
responsible for the listed devices. This means that when a control message
is sent back upstream, the message—which is tagged as being relevant for a
specific device, or type of device—will be forwarded (through the
<a class="reference internal" href="#_CPPv4N18BInputServerDevice7ControlEPKcP3voi6uint32P8BMessage" title="BInputServerDevice::Control"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Control()</span></code></a> hook) to the
responsible <span class="hclass">BInputServerDevice</span> object(s). Typically, you
initially register your devices as part of the constructor or
<a class="reference internal" href="#_CPPv4N18BInputServerDevice9InitCheckEv" title="BInputServerDevice::InitCheck"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">InitCheck()</span></code></a>. Registration is
cumulative—each <span class="hmethod">RegisterDevices()</span> call adds to the object’s
current list of devices.</p>
<p><span class="hmethod">UnregisterDevices()</span> tells the Input Server that this object is
no longer responsible for the listed devices. The devices are automatically
unregistered when your object is deleted.</p>
<p><span class="hmethod">RegisterDevices()</span> invokes <a class="reference internal" href="#_CPPv4N18BInputServerDevice5StartEPKcPv" title="BInputServerDevice::Start"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Start()</span></code></a> for each device in the devices list;
<span class="hmethod">UnregisterDevices()</span> invokes <a class="reference internal" href="#_CPPv4N18BInputServerDevice4StopEPKcPv" title="BInputServerDevice::Stop"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Stop()</span></code></a>.</p>
<p>For both functions, the devices list must be <span class="cpp-expr sig sig-inline cpp"><span class="n">NULL</span></span>-terminated,
and the caller retains ownership of the list and its contents.</p>
<p>Note that the BeOS currently only targets the device types when sending a
<a class="reference internal" href="#_CPPv4N18BInputServerDevice7ControlEPKcP3voi6uint32P8BMessage" title="BInputServerDevice::Control"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Control()</span></code></a> message. For example,
let’s say you’ve registered two pointing devices and a keyboard:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">status_t</span><span class="w"> </span><span class="nf">MyISDevice::InitCheck</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="w">   </span><span class="n">input_device_ref</span><span class="w"> </span><span class="o">**</span><span class="n">devices</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">input_device_ref</span><span class="w"> </span><span class="o">**</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">input_device_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span><span class="w"></span>
<span class="w">   </span><span class="n">input_device_ref</span><span class="w"> </span><span class="n">mouse1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;Mouse 1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">B_POINTING_DEVICE</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="k">this</span><span class="p">)};</span><span class="w"></span>
<span class="w">   </span><span class="n">input_device_ref</span><span class="w"> </span><span class="n">mouse2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;Mouse 2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">B_POINTING_DEVICE</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="k">this</span><span class="p">)};</span><span class="w"></span>
<span class="w">   </span><span class="n">input_device_ref</span><span class="w"> </span><span class="n">keyboard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;Keyboard&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">B_KEYBOARD_DEVICE</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="k">this</span><span class="p">)};</span><span class="w"></span>
<span class="w">   </span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mouse1</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">devices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mouse2</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">devices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">keyboard</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">devices</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">RegisterDevices</span><span class="p">(</span><span class="n">devices</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="p">...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>When the user fiddles with the Mouse preference (more specifically, if an
application calls <span class="xref std std-ref">set_mouse_speed()</span> et. al.), this object will
receive two <a class="reference internal" href="#_CPPv4N18BInputServerDevice7ControlEPKcP3voi6uint32P8BMessage" title="BInputServerDevice::Control"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Control()</span></code></a> messages:
one targets “Mouse 1”, and the other targets “Mouse 2”. That’s because the
mouse and keyboard functions (as defined by the BeOS and as used by the
system preferences) know which type of device to control, but they don’t
provide a means for more granular identification. If you need a UI that
identifies specific devices, you have to create the UI yourself, and use a
<a class="reference internal" href="input-device.html#_CPPv412BInputDevice" title="BInputDevice"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">BInputDevice</span></code></a> object to tune the control messages that are sent
back upstream.</p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>The functions don’t let you un/register the same device definition twice,
and <span class="hmethod">RegisterDevices()</span> won’t register a device that doesn’t have
a name (although the name can be “”). However, the functions don’t complain
about violations of these conditions as long as at least one definition is
properly formed.</p>
</div>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>At least one of the devices was registered.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ERROR</span></code>.</p></td>
<td><p>None of the devices were registered.</p></td>
</tr>
</tbody>
</table>
<section id="_CPPv4N18BInputServerDevice21StartMonitoringDeviceEPKc">
</section>
<section id="_CPPv4N18BInputServerDevice20StopMonitoringDeviceEPKc">
</section>
<h3>
StartMonitoringDevice(), StopMonitoringDevice()</h3><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">StartMonitoringDevice</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">deviceDir</span><span class="sig-paren">)</span></pre><pre style="background: #f3f3f3; line-height: 2em"><a class="reference internal" href="../storage/the-node-monitor.html#_CPPv48status_t10BMessenger" title="status_t"><span class="n">status_t</span></a><span class="w"> </span><span class="sig-prename descclassname"><a class="reference internal" href="#_CPPv418BInputServerDevice" title="BInputServerDevice"><span class="n">BInputServerDevice</span></a><span class="p">::</span></span><span class="n">StopMonitoringDevice</span><span class="sig-paren">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="n sig-param">deviceDir</span><span class="sig-paren">)</span></pre><p>These are convenient covers for the <span class="xref std std-ref">Node Monitor</span>’s
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">watch_node()</span></code> and <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">stop_watching()</span></code> functions. You use them to watch for physical devices
that are attached and detached, as indicated by changes to subdirectories
of the system device directory (/dev).</p>
<p><span class="hparameter">deviceDir</span> is the name of the device subdirectory that you want
to watch. The /dev/ root is automatically prepended; for example, if you
want to watch for new ps2 mice, you would pass input/mouse/ps2 as the
<span class="hparameter">deviceDir</span> name. The Node Monitor is told to look for changes to
the directory (<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_WATCH_DIRECTORY</span></code> opcode). When an entry
is added or removed, this object receives a
<code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NODE_MONITOR</span></code> message delivered to its
<a class="reference internal" href="#_CPPv4N18BInputServerDevice7ControlEPKcP3voi6uint32P8BMessage" title="BInputServerDevice::Control"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Control()</span></code></a> function.</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Return Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_OK</span></code>.</p></td>
<td><p>Success.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_ERROR</span></code>.</p></td>
<td><p>Unspecified failure.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_NOT_A_DIRECTORY</span></code>.</p></td>
<td><p>You’re trying to monitor a node that isn’t a directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">B_BAD_VALUE</span></code>.</p></td>
<td><p><span class="hparameter">deviceDir</span> not found.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


        <div class="clearer"></div>
      </div>
          </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="input-device.html">BInputDevice</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="input-server-filter.html">BInputServerFilter</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Haiku, Inc..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>